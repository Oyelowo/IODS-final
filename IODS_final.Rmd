---
title: "IODS_final"
author: "Oyedayo Oyelowo"
date: "17 December 2017"
output: html_document
---

##Loading the data set and packages
```{r, message=FALSE, warning=FALSE}
#clear environment
rm(list=ls())

#read data
fpath<- "C:/Users/oyeda/Desktop/OPEN_DATA_SCIENCE/IODS-final/data/"
alco_data <- read.table(paste0(fpath, "alcohol_student.csv"), sep=",", header=T)
alco_data<- alco_data[,-1]

#necessary packages
#install.packages("dismo")
library(dplyr)
library(ggplot2)
library(corrplot)
library(GGally)
library(tidyr)
library(tidyverse)
library(gbm)
library(dismo)
library(caTools)
library(mgcv)
library(MASS)
library(FactoMineR)
```


#AIMS AND OBJECTUIVES 
My aim is to demonstrate the use of various statistical techniques in getting insight in to
the dataset, to understand the patterns alcohol consumption consumptions and absences amongst students in two schools. Further, I seek to explore the distribution of grades amongst male and female students; and factors that might be affecting this.
Firstly, I will use the basic desctiptive statitstics to understand the distribution, correlation and dependencies(cor, barplot, histogram, biplot etc)
I will also be using the regression models(_**Generalized Linear Model(GLM), Generalised Additive Model(GAM) and Generalised Boosted Model(GBM))**_. Furthermore, I will test my models using 70:30 data split.

I will also explore Linear Discriminant Analysis(LDA) and  Multiple Correspondence Analysis(MCA), to classify and categorise the data.


#RESEARCH QUESTIONS
-  What are the factors considerably affecting students' grades?

-  What are the factors causing absences amongst students?

-  What are the factors significantly causing high alcohol consumption amongst students.



#DATA EXPLORATION
```{r, message=FALSE, warning=FALSE}
categ = apply(alco_data, 2, function(x) nlevels(as.factor(x)))
categ
dim(alco_data)
str(alco_data)
summary(alco_data)
#glimpse(alco_data)

# ####Grade:
#bar plot of the variables
gather(alco_data) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() 


```

  To avoid, confusion, I will copy the data into a new data frame for MCA. Firstly, I will be extracting the categorical variables, as factors

```{r, message=FALSE, warning=FALSE}
#To avoid, confusion, I will copy the data into a new data frame for MCA
data_mca <- alco_data

#Firstly, I will be extracting the categorical variables, as factors
#now, filter them out for the MCA
data_mca_fac1<-Filter(is.factor, data_mca)

high_use<-factor(alco_data[,"high_use"])
data_mca_fac1 <- cbind.data.frame(data_mca_fac1, high_use)

```

#MCA plot
```{r, message=FALSE, warning=FALSE}
#par(mfrow=c(1,2))
#now, perform the MCA on the catergorial/qualitative variables
mca_alco1 <- MCA(data_mca_fac1, graph = T)

#plot it
plot(mca_alco1, invisible=c("ind"), habillage="quali")
#par(mfrow=c(1,1))


```

##BETTER VISUALISATION FOR MCA
```{r, message=FALSE, warning=FALSE}
# Getting a better biplot for MCA using ggplot
## number of categories per variable
categ = apply(data_mca_fac1, 2, function(x) nlevels(as.factor(x)))
categ

# data frame with variable coordinates
mca_vars_df = data.frame(mca_alco1$var$coord, Variable = rep(names(categ), categ))
#mca_vars_df


# data frame with observation coordinates
mca_obs_df = data.frame(mca_alco1$ind$coord)


# MCA plot of observations and categories
ggplot(data = mca_obs_df, aes(x = Dim.1, y = Dim.2)) +
  geom_hline(yintercept = 0, colour = "gray70") +
  geom_vline(xintercept = 0, colour = "gray70") +
  geom_point(colour = "gray50", alpha = 0.0) +
  geom_density2d(colour = "gray80") +
  geom_text(data = mca_vars_df, 
            aes(x = Dim.1, y = Dim.2, 
                label = rownames(mca_vars_df), colour = Variable)) +
  ggtitle("MCA plot of variables using R package FactoMineR") +
  scale_colour_discrete(name = "Variable")
```

  Here, we can see that female students generally attend school
because of her reputation and get more school support.
They also have family support and are able to attend paid extra
classes. Most of their father's job are in the health sector.
High alcohol consumption is more rampant amongst female students
compared to their male counterparts with high alcohol use.
male students also attend the school based on course preference
and other reasons. By and large, they do not attend paid extra classes compared to the female students and also do not get family and school support like the frmale students.
Lastly, they mosly have no intention of pursuing higher education. This is explored further by categorising more continuous variables such as grades, absences, to allow for comparison with other variables.




```{r, message=FALSE, warning=FALSE}


```

```{r, message=FALSE, warning=FALSE}


```

```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```




```{r, message=FALSE, warning=FALSE}


```




```{r, message=FALSE, warning=FALSE}


```




```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```

```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```

```{r, message=FALSE, warning=FALSE}


```
```{r, message=FALSE, warning=FALSE}


```

```{r, message=FALSE, warning=FALSE}


```

```{r, message=FALSE, warning=FALSE}


```

```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```



```{r, message=FALSE, warning=FALSE}


```


```{r, message=FALSE, warning=FALSE}


```